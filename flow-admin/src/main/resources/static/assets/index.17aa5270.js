import{dl as O,c6 as W,V as $,a as k,x as U,y as q,h as E,a9 as z,o as J,dW as K,c2 as Q,L as X,T as Y,U as Z,c4 as ee,q as T,_ as B,ck as te,ap as F,aw as ne}from"./index.e61ad282.js";import{t as I}from"./throttleByAnimationFrame.7312e722.js";function y(n){return n!==window?n.getBoundingClientRect():{top:0,bottom:window.innerHeight}}function _(n,e,t){if(t!==void 0&&e.top>n.top-t)return"".concat(t+e.top,"px")}function H(n,e,t){if(t!==void 0&&e.bottom<n.bottom+t){var a=window.innerHeight-e.bottom;return"".concat(t+a,"px")}}var j=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"],m=[];function M(n,e){if(!!n){var t=m.find(function(a){return a.target===n});t?t.affixList.push(e):(t={target:n,affixList:[e],eventHandlers:{}},m.push(t),j.forEach(function(a){t.eventHandlers[a]=O(n,a,function(){t.affixList.forEach(function(s){var w=s.exposed.lazyUpdatePosition;w()},(a==="touchstart"||a==="touchmove")&&W?{passive:!0}:!1)})}))}}function R(n){var e=m.find(function(t){var a=t.affixList.some(function(s){return s===n});return a&&(t.affixList=t.affixList.filter(function(s){return s!==n})),a});e&&e.affixList.length===0&&(m=m.filter(function(t){return t!==e}),j.forEach(function(t){var a=e.eventHandlers[t];a&&a.remove&&a.remove()}))}function ae(){return typeof window!="undefined"?window:null}var p;(function(n){n[n.None=0]="None",n[n.Prepare=1]="Prepare"})(p||(p={}));var ie=function(){return{offsetTop:Number,offsetBottom:Number,target:{type:Function,default:ae},prefixCls:String,onChange:Function,onTestUpdatePosition:Function}},oe=k({compatConfig:{MODE:3},name:"AAffix",props:ie(),setup:function(e,t){var a=t.slots,s=t.emit,w=t.expose,h=U(),P=U(),f=q({affixStyle:void 0,placeholderStyle:void 0,status:p.None,lastAffix:!1,prevTarget:null,timeout:null}),x=ne(),S=E(function(){return e.offsetBottom===void 0&&e.offsetTop===void 0?0:e.offsetTop}),b=E(function(){return e.offsetBottom}),V=function(){var o=f.status,v=f.lastAffix,d=e.target;if(!(o!==p.Prepare||!P.value||!h.value||!d)){var l=d();if(!!l){var r={status:p.None},g=y(l),u=y(h.value),L=_(u,g,S.value),N=H(u,g,b.value);L!==void 0?(r.affixStyle={position:"fixed",top:L,width:u.width+"px",height:u.height+"px"},r.placeholderStyle={width:u.width+"px",height:u.height+"px"}):N!==void 0&&(r.affixStyle={position:"fixed",bottom:N,width:u.width+"px",height:u.height+"px"},r.placeholderStyle={width:u.width+"px",height:u.height+"px"}),r.lastAffix=!!r.affixStyle,v!==r.lastAffix&&s("change",r.lastAffix),F(f,r)}}},C=function(){F(f,{status:p.Prepare,affixStyle:void 0,placeholderStyle:void 0}),x.update()},c=I(function(){C()}),A=I(function(){var i=e.target,o=f.affixStyle;if(i&&o){var v=i();if(v&&h.value){var d=y(v),l=y(h.value),r=_(l,d,S.value),g=H(l,d,b.value);if(r!==void 0&&o.top===r||g!==void 0&&o.bottom===g)return}}C()});w({updatePosition:c,lazyUpdatePosition:A}),z(function(){return e.target},function(i){var o=(i==null?void 0:i())||null;f.prevTarget!==o&&(R(x),o&&(M(o,x),c()),f.prevTarget=o)}),z(function(){return[e.offsetTop,e.offsetBottom]},c),J(function(){var i=e.target;i&&(f.timeout=setTimeout(function(){M(i(),x),c()}))}),K(function(){V()}),Q(function(){clearTimeout(f.timeout),R(x),c.cancel(),A.cancel()});var D=X("affix",e),G=D.prefixCls;return function(){var i,o=f.affixStyle,v=f.placeholderStyle,d=Y(Z({},G.value,o)),l=ee(e,["prefixCls","offsetTop","offsetBottom","target","onChange","onTestUpdatePosition"]);return T(te,{onResize:c},{default:function(){return[T("div",B(B({},l),{},{style:v,ref:h}),[T("div",{class:d,ref:P,style:o},[(i=a.default)===null||i===void 0?void 0:i.call(a)])])]}})}}}),ue=$(oe);export{ue as A};
