var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(t,r,o)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,i=(e,t,r)=>new Promise(((o,a)=>{var i=e=>{try{n(r.next(e))}catch(t){a(t)}},s=e=>{try{n(r.throw(e))}catch(t){a(t)}},n=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,s);n((r=r.apply(e,t)).next())}));import{_ as s,a as n}from"./useModal.ddd2c5cc.js";import{_ as d}from"./BasicForm.9118d7fd.js";import{u as l}from"./useForm.7b000bd0.js";import{a as c}from"./app.data.9e237876.js";import{r as m}from"./app.9e4d858d.js";import{aX as p,g as u}from"./index.bfbdc958.js";import{k as f,aJ as b,ad as j,cb as y,aw as v,cc as g,r as x,u as h,f as w,K as S,o as M,n as O,Q as C,q as F,Y as P,s as _,N as B}from"./vendor.56d2c57f.js";/* empty css              */import"./useWindowSizeFn.d0559e60.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./CountdownInput.a238b96b.js";import"./uuid.c53863e7.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./download.c3ab6d96.js";import"./StrengthMeter.ab008fc6.js";const{TextArea:K}=j;var R=f({name:"SecretKeyModal",components:{BasicModal:s,BasicForm:d,Button:b,Input:j,TextArea:K,Space:y,Popconfirm:v,QuestionCircleOutlined:g},emits:["success","register"],setup(e,{emit:s}){const d=x(!0),f=x(""),{createMessage:b}=u(),{clipboardRef:j,copiedRef:y}=p(),[v,{resetFields:g,updateSchema:S,setFieldsValue:M,validate:O}]=l({labelWidth:100,schemas:c,showActionButtonGroup:!1}),[C,{setModalProps:F,closeModal:P}]=n((e=>i(this,null,(function*(){yield g(),F({confirmLoading:!1}),d.value=!!(null==e?void 0:e.isUpdate);let i=e.record;f.value=i.secretKey,h(d)&&M(((e,i)=>{for(var s in i||(i={}))r.call(i,s)&&a(e,s,i[s]);if(t)for(var s of t(i))o.call(i,s)&&a(e,s,i[s]);return e})({},e.record))}))));return{registerModal:C,registerForm:v,getTitle:w((()=>h(d)?"修改":"新增")),handleCopy:function(){try{const e=h(f);if(!e)return void b.warning("请重新获取密钥！");j.value=e,h(y)&&b.success("拷贝成功！")}finally{F({confirmLoading:!1})}},refreshSecretKeyHandle:function(e){return i(this,null,(function*(){try{F({confirmLoading:!0});const t=yield m(e.id);f.value=t,M({secretKey:t})}finally{F({confirmLoading:!1})}}))}}}});const k={class:""},T=P(" 获取 "),A=P(" 复制 ");R.render=function(e,t,r,o,a,i){const s=S("TextArea"),n=S("QuestionCircleOutlined"),d=S("a-button"),l=S("Popconfirm"),c=S("Space"),m=S("BasicForm"),p=S("BasicModal");return M(),O(p,B(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:C((()=>[F(m,{onRegister:e.registerForm},{snSlot:C((({model:e,field:t})=>[P(_(e[t]),1)])),secretKeySlot:C((({model:t,field:r})=>[F("div",k,[F(s,{readonly:"",rows:4,value:t[r],"onUpdate:value":e=>t[r]=e},null,8,["value","onUpdate:value"]),F(c,null,{default:C((()=>[F(l,{title:"重新获取秘钥吗？",onConfirm:r=>e.refreshSecretKeyHandle(t)},{icon:C((()=>[F(n,{style:{color:"red"}})])),default:C((()=>[F(d,null,{default:C((()=>[T])),_:1})])),_:2},1032,["onConfirm"]),F(d,{type:"primary",onClick:e.handleCopy},{default:C((()=>[A])),_:1},8,["onClick"])])),_:2},1024)])])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};export default R;
