var $e=Object.defineProperty,Pe=Object.defineProperties;var je=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var ce=(e,t,a)=>t in e?$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,O=(e,t)=>{for(var a in t||(t={}))me.call(t,a)&&ce(e,a,t[a]);if(re)for(var a of re(t))Ue.call(t,a)&&ce(e,a,t[a]);return e},ie=(e,t)=>Pe(e,je(t));var de=(e,t,a)=>new Promise((y,v)=>{var K=k=>{try{p(a.next(k))}catch(E){v(E)}},s=k=>{try{p(a.throw(k))}catch(E){v(E)}},p=k=>k.done?y(k.value):Promise.resolve(k.value).then(K,s);p((a=a.apply(e,t)).next())});import{eV as Ve,eW as He,eX as Re,eY as Ye,eZ as Xe,e_ as ze,em as Ge,es as oe,e$ as We,f0 as qe,f1 as Je,f2 as Ze,a as be,x as Ae,f3 as Qe,e as et,h as I,a9 as P,i as M,j as m,k as c,aF as tt,m as $,l as q,C as U,D as ue,t as he,dT as nt,s as fe,q as L,f4 as at,ba as lt,G as Z,aE as st,ci as rt,aG as ct,aH as it,f5 as dt,b9 as Q,bo as ot,cJ as ut,bw as ht,f6 as ft,bV as yt,aj as ee,f7 as ye,y as pe,ao as X,dw as pt,ar as gt,aA as J,f8 as kt,eA as St,N as V,o as Kt,f9 as xt,dR as Ct,cE as bt,b4 as At,z as ge,B as ke,bH as Lt,aC as Et,ej as Se,dO as vt,bt as Ke,cF as _t}from"./index.ef013507.js";import{f as Tt}from"./fromPairs.84aabb58.js";import{b as Bt}from"./index.4dfcf0e9.js";import{u as wt}from"./useContextMenu.eed63f27.js";import{g as Dt}from"./get.fbc063d7.js";var Ft=200;function Nt(e,t,a,y){var v=-1,K=Ye,s=!0,p=e.length,k=[],E=t.length;if(!p)return k;a&&(t=Ve(t,He(a))),y?(K=Xe,s=!1):t.length>=Ft&&(K=ze,s=!1,t=new Re(t));e:for(;++v<p;){var S=e[v],d=a==null?S:a(S);if(S=y||S!==0?S:0,s&&d===d){for(var n=E;n--;)if(t[n]===d)continue e;k.push(S)}else K(t,d,y)||k.push(S)}return k}var Mt=Ge(function(e,t){return oe(e)?Nt(e,We(t,1,oe,!0)):[]}),It=Mt;function te(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((a,y)=>a+te(e,y),""):Object.keys(t).reduce((a,y)=>a+(t[y]?te(e,y):""),""):""}function Ot(e){return(t,a)=>(t&&typeof t!="string"&&(a=t,t=""),t=t?`${e}__${t}`:e,`${t}${te(t,a)}`)}function Le(e){return[Ot(`${qe}-${e}`)]}const xe=Symbol(),Ce=Symbol();function $t(e,t){if(!Je(e)||!!e[Ce])return e;const{values:a,required:y,default:v,type:K,validator:s}=e,p=a||s?k=>{let E=!1,S=[];if(a&&(S=[...a,v],E||(E=S.includes(k))),s&&(E||(E=s(k))),!E&&S.length>0){const d=[...new Set(S)].map(n=>JSON.stringify(n)).join(", ");Ze(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${d}], got value ${JSON.stringify(k)}.`)}return E}:void 0;return{type:typeof K=="object"&&Object.getOwnPropertySymbols(K).includes(xe)?K[xe]:K,required:!!y,default:v,validator:p,[Ce]:!0}}const Pt=e=>Tt(Object.entries(e).map(([t,a])=>[t,$t(a,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const jt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],mt=Pt({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),Ut={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Vt=be({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const a=e,y=Ae(""),[v]=Le("tree-header"),K=Qe(),{t:s}=et(),p=I(()=>{const n=K.headerTitle||a.title;return["mr-1","w-full",{["ml-5"]:n}]}),k=I(()=>{const{checkable:n}=a,r=[{label:s("component.tree.expandAll"),value:T.EXPAND_ALL},{label:s("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:n}];return n?[{label:s("component.tree.selectAll"),value:T.SELECT_ALL},{label:s("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:n},...r,{label:s("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:s("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:r});function E(n){var i,o,h,u;const{key:r}=n;switch(r){case T.SELECT_ALL:(i=a.checkAll)==null||i.call(a,!0);break;case T.UN_SELECT_ALL:(o=a.checkAll)==null||o.call(a,!1);break;case T.EXPAND_ALL:(h=a.expandAll)==null||h.call(a,!0);break;case T.UN_EXPAND_ALL:(u=a.expandAll)==null||u.call(a,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function S(n){t("search",n)}const d=ht(S,200);return P(()=>y.value,n=>{d(n)}),P(()=>a.searchText,n=>{n!==y.value&&(y.value=n)}),(n,r)=>(M(),m("div",{class:fe([c(v)(),"flex px-2 py-1.5 items-center"])},[c(K).headerTitle?tt(n.$slots,"headerTitle",{key:0}):$("",!0),!c(K).headerTitle&&n.title?(M(),q(c(nt),{key:1,helpMessage:n.helpMessage},{default:U(()=>[ue(he(n.title),1)]),_:1},8,["helpMessage"])):$("",!0),n.search||n.toolbar?(M(),m("div",Ut,[n.search?(M(),m("div",{key:0,class:fe(c(p))},[L(c(at),{placeholder:c(s)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":r[0]||(r[0]=i=>y.value=i)},null,8,["placeholder","value"])],2)):$("",!0),n.toolbar?(M(),q(c(ut),{key:1,onClick:r[1]||(r[1]=ot(()=>{},["prevent"]))},{overlay:U(()=>[L(c(lt),{onClick:E},{default:U(()=>[(M(!0),m(Z,null,st(c(k),i=>(M(),m(Z,{key:i.value},[L(c(rt),ct(it({key:i.value})),{default:U(()=>[ue(he(i.label),1)]),_:2},1040),i.divider?(M(),q(c(dt),{key:0})):$("",!0)],64))),128))]),_:1})]),default:U(()=>[L(c(Q),{icon:"ion:ellipsis-vertical"})]),_:1})):$("",!0)])):$("",!0)],2))}}),Ht=({icon:e})=>e?ft(e)?yt(Q,{icon:e,class:"mr-1"}):Q:null;function Rt(e,t){function a(d){const n=[],r=d||c(e),{key:i,children:o}=c(t);if(!o||!i)return n;for(let h=0;h<r.length;h++){const u=r[h];n.push(u[i]);const g=u[o];g&&g.length&&n.push(...a(g))}return n}function y(d){const n=[],r=d||c(e),{key:i,children:o}=c(t);if(!o||!i)return n;for(let h=0;h<r.length;h++){const u=r[h];u.disabled!==!0&&u.selectable!==!1&&n.push(u[i]);const g=u[o];g&&g.length&&n.push(...y(g))}return n}function v(d,n){const r=[],i=n||c(e),{key:o,children:h}=c(t);if(!h||!o)return r;for(let u=0;u<i.length;u++){const g=i[u],_=g[h];d===g[o]?(r.push(g[o]),_&&_.length&&r.push(...a(_))):_&&_.length&&r.push(...v(d,_))}return r}function K(d,n,r){if(!d)return;const i=r||c(e),{key:o,children:h}=c(t);if(!(!h||!o))for(let u=0;u<i.length;u++){const g=i[u],_=g[h];if(g[o]===d){i[u]=O(O({},i[u]),n);break}else _&&_.length&&K(d,n,g[h])}}function s(d=1,n,r=1){if(!d)return[];const i=[],o=n||c(e)||[];for(let h=0;h<o.length;h++){const u=o[h],{key:g,children:_}=c(t),z=g?u[g]:"",j=_?u[_]:[];i.push(z),j&&j.length&&r<d&&(r+=1,i.push(...s(d,j,r)))}return i}function p({parentKey:d=null,node:n,push:r="push"}){const i=ee(c(e));if(!d){i[r](n),e.value=i;return}const{key:o,children:h}=c(t);!h||!o||(ye(i,u=>{if(u[o]===d)return u[h]=u[h]||[],u[h][r](n),!0}),e.value=i)}function k({parentKey:d=null,list:n,push:r="push"}){const i=ee(c(e));if(!(!n||n.length<1))if(d){const{key:o,children:h}=c(t);if(!h||!o)return;ye(i,u=>{if(u[o]===d){u[h]=u[h]||[];for(let g=0;g<n.length;g++)u[h][r](n[g]);return e.value=i,!0}})}else for(let o=0;o<n.length;o++)i[r](n[o])}function E(d,n){if(!d)return;const r=n||c(e),{key:i,children:o}=c(t);if(!(!o||!i))for(let h=0;h<r.length;h++){const u=r[h],g=u[o];if(u[i]===d){r.splice(h,1);break}else g&&g.length&&E(d,u[o])}}function S(d,n,r){return!d&&d!==0?null:((n||c(e)).forEach(o=>{if((r==null?void 0:r.key)||(r==null?void 0:r.key)===0)return r;if(o.key===d){r=o;return}o.children&&o.children.length&&(r=S(d,o.children,r))}),r||null)}return{deleteNodeByKey:E,insertNodeByKey:p,insertNodesByKey:k,filterByLevel:s,updateNodeByKey:K,getAllKeys:a,getChildrenKeys:v,getEnabledKeys:y,getSelectedNode:S}}function Yt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!bt(e)}var Zt=be({name:"BasicTree",inheritAttrs:!1,props:mt,emits:jt,setup(e,{attrs:t,slots:a,emit:y,expose:v}){const[K]=Le("tree"),s=pe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=pe({startSearch:!1,searchText:"",searchData:[]}),k=Ae([]),[E]=wt(),S=I(()=>{const{fieldNames:l}=e;return O({children:"children",title:"title",key:"key"},l)}),d=I(()=>{let l=ie(O(O({blockNode:!0},t),e),{expandedKeys:s.expandedKeys,selectedKeys:s.selectedKeys,checkedKeys:s.checkedKeys,checkStrictly:s.checkStrictly,fieldNames:c(S),"onUpdate:expandedKeys":f=>{s.expandedKeys=f,y("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{s.selectedKeys=f,y("update:selectedKeys",f)},onCheck:(f,b)=>{let x=X(s.checkedKeys);if(pt(x)&&p.startSearch){const A=b.node.eventKey;x=It(x,z(A)),b.checked&&x.push(A),s.checkedKeys=x}else s.checkedKeys=f;const C=X(s.checkedKeys);y("update:value",C),y("check",C,b)},onRightClick:_e});return gt(l,"treeData","class")}),n=I(()=>p.startSearch?p.searchData:c(k)),r=I(()=>!n.value||n.value.length===0),{deleteNodeByKey:i,insertNodeByKey:o,insertNodesByKey:h,filterByLevel:u,updateNodeByKey:g,getAllKeys:_,getChildrenKeys:z,getEnabledKeys:j,getSelectedNode:Ee}=Rt(k,S);function ve(l,f){return!f&&e.renderIcon&&J(e.renderIcon)?e.renderIcon(l):f}function _e(b){return de(this,arguments,function*({event:l,node:f}){var D;const{rightMenuList:x=[],beforeRightClick:C}=e;let A={event:l,items:[]};if(C&&J(C)){let B=yield C(f,l);Array.isArray(B)?A.items=B:Object.assign(A,B)}else A.items=x;!((D=A.items)!=null&&D.length)||(A.items=A.items.filter(B=>!B.hidden),E(A))})}function H(l){s.expandedKeys=l}function Te(){return s.expandedKeys}function ne(l){s.selectedKeys=l}function Be(){return s.selectedKeys}function ae(l){s.checkedKeys=l}function we(){return s.checkedKeys}function le(l){s.checkedKeys=l?j():[]}function G(l){s.expandedKeys=l?_():[]}function De(l){s.checkStrictly=l}P(()=>e.searchValue,l=>{l!==p.searchText&&(p.searchText=l)},{immediate:!0}),P(()=>e.treeData,l=>{l&&W(p.searchText)});function W(l){if(l!==p.searchText&&(p.searchText=l),y("update:searchValue",l),!l){p.startSearch=!1;return}const{filterFn:f,checkable:b,expandOnSearch:x,checkOnSearch:C,selectedOnSearch:A}=c(e);p.startSearch=!0;const{title:D,key:B}=c(S),F=[];if(p.searchData=kt(c(k),w=>{var R,Y;const N=f?f(l,w,c(S)):(Y=(R=w[D])==null?void 0:R.includes(l))!=null?Y:!1;return N&&F.push(w[B]),N},c(S)),x){const w=St(p.searchData).map(N=>N[B]);w&&w.length&&H(w)}C&&b&&F.length&&ae(F),A&&F.length&&ne(F)}function Fe(l,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!s.expandedKeys.includes(l))H([...s.expandedKeys,l]);else{const b=[...s.expandedKeys],x=b.findIndex(C=>C===l);x!==-1&&b.splice(x,1),H(b)}}V(()=>{k.value=e.treeData}),Kt(()=>{const l=parseInt(e.defaultExpandLevel);l>0?s.expandedKeys=u(l):e.defaultExpandAll&&G(!0)}),V(()=>{s.expandedKeys=e.expandedKeys}),V(()=>{s.selectedKeys=e.selectedKeys}),V(()=>{s.checkedKeys=e.checkedKeys}),P(()=>e.value,()=>{s.checkedKeys=X(e.value||[])},{immediate:!0}),P(()=>s.checkedKeys,()=>{const l=X(s.checkedKeys);y("update:value",l),y("change",l)}),V(()=>{s.checkStrictly=e.checkStrictly});const Ne={setExpandedKeys:H,getExpandedKeys:Te,setSelectedKeys:ne,getSelectedKeys:Be,setCheckedKeys:ae,getCheckedKeys:we,insertNodeByKey:o,insertNodesByKey:h,deleteNodeByKey:i,updateNodeByKey:g,getSelectedNode:Ee,checkAll:le,expandAll:G,filterByLevel:l=>{s.expandedKeys=u(l)},setSearchValue:l=>{W(l)},getSearchValue:()=>p.searchText};function Me(l){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((b,x)=>{var A;let C=!0;return J(b.show)?C=(A=b.show)==null?void 0:A.call(b,l):Ke(b.show)&&(C=b.show),C?L("span",{key:x,class:K("action")},[b.render(l)]):null})}const Ie=I(()=>{const l=ee(n.value);return xt(l,(f,b)=>{var se;const x=p.searchText,{highlight:C}=c(e),{title:A,key:D,children:B}=c(S),F=ve(f,f.icon),w=Dt(f,A),N=x?w.indexOf(x):-1,R=p.startSearch&&!vt(x)&&C&&N!==-1,Y=`color: ${Ke(C)?"#f50":C}`,Oe=R?L("span",{class:(se=c(d))!=null&&se.blockNode?`${K("content")}`:""},[L("span",null,[w.substr(0,N)]),L("span",{style:Y},[x]),L("span",null,[w.substr(N+x.length)])]):w;return f[A]=L("span",{class:`${K("title")} pl-2`,onClick:Fe.bind(null,f[D],f[B])},[a!=null&&a.title?_t(a,"title",f):L(Z,null,[F&&L(Ht,{icon:F},null),Oe,L("span",{class:K("actions")},[Me(f)])])]),f}),l});return v(Ne),()=>{let l;const{title:f,helpMessage:b,toolbar:x,search:C,checkable:A}=e,D=f||x||C||a.headerTitle,B={height:"calc(100% - 38px)"};return L("div",{class:[K(),"h-full",t.class]},[D&&L(Vt,{checkable:A,checkAll:le,expandAll:G,title:f,search:C,toolbar:x,helpMessage:b,onStrictlyChange:De,onSearch:W,searchText:p.searchText},Yt(l=Ct(a))?l:{default:()=>[l]}),L(At,{wrapperClassName:c(e.treeWrapperClassName),spinning:c(e.loading),tip:"\u52A0\u8F7D\u4E2D..."},{default:()=>[ge(L(Lt,{style:B},{default:()=>[L(Bt,Et(c(d),{showIcon:!1,treeData:Ie.value}),null)]}),[[ke,!c(r)]]),ge(L(Se,{image:Se.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ke,c(r)]])]})])}}});export{Zt as _};
