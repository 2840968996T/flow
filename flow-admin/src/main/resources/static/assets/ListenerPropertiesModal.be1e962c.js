var C=Object.defineProperty;var g=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var B=(r,t,e)=>t in r?C(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,h=(r,t)=>{for(var e in t||(t={}))D.call(t,e)&&B(r,e,t[e]);if(g)for(var e of g(t))k.call(t,e)&&B(r,e,t[e]);return r};var F=(r,t,e)=>new Promise((m,a)=>{var n=s=>{try{i(e.next(s))}catch(l){a(l)}},u=s=>{try{i(e.throw(s))}catch(l){a(l)}},i=s=>s.done?m(s.value):Promise.resolve(s.value).then(n,u);i((e=e.apply(r,t)).next())});import{B as w,a as R}from"./index.a492e5cd.js";import{B as x}from"./BasicForm.027cbf67.js";import{u as A}from"./useForm.81406efc.js";import{k as L,l as N,m as $}from"./listener.data.d3a7fe7c.js";import{az as S,a as T,x as V,k as E,h as O,aB as v,i as U,l as j,C as q,q as z,aC as G}from"./index.e61ad282.js";import"./useWindowSizeFn.27de1b1b.js";import"./FullscreenOutlined.3a424424.js";/* empty css              *//* empty css               */import"./index.9f50e000.js";import"./index.ce1ab63a.js";import"./Checkbox.bb68ead3.js";import"./index.99ef178c.js";import"./index.6e0a0264.js";import"./index.8f86dec4.js";import"./index.9f299dd3.js";import"./index.9233793b.js";import"./get.bca7403a.js";import"./index.d92fc3ac.js";import"./eagerComputed.d3c262c3.js";import"./index.6749d186.js";import"./_baseIteratee.7ece590b.js";import"./DeleteOutlined.3b47e95d.js";import"./index.114515de.js";import"./useRefs.0c428178.js";import"./Form.8b25370b.js";import"./Col.f72eb8d0.js";import"./useFlexGapSupport.ed2a5fc1.js";import"./useSize.5a37866d.js";import"./transButton.2c723edc.js";import"./index.8ba0bfed.js";import"./index.dbdde179.js";import"./index.e8295ad9.js";import"./uuid.2b29000c.js";import"./download.810571da.js";import"./base64Conver.08b9f4ec.js";import"./index.ebd81f61.js";import"./index.6d7de824.js";import"./uniqBy.8c214189.js";const I=T({name:"ListenerPropertiesModal",components:{BasicModal:w,BasicForm:x},emits:["success","register"],setup(r,{emit:t}){const e=V(!0);let m=[{label:"\u5B57\u7B26\u4E32",value:"string"},{label:"\u8868\u8FBE\u5F0F",value:"expression"}],a={};m.forEach(o=>{a[o.value]=o.label});const[n,{resetFields:u,updateSchema:i,setFieldsValue:s,validate:l}]=A({labelWidth:100,schemas:L,showActionButtonGroup:!1}),y=o=>[{trigger:"blur",validator:(p,c)=>c?N({id:o.id,field:o.field,fieldValue:c,fieldName:o.fieldName}).then(f=>f?Promise.resolve():Promise.reject(o.fieldName+"\u5DF2\u5B58\u5728\uFF0C\u8BF7\u4FEE\u6539\uFF01")).catch(f=>Promise.reject(f)):Promise.resolve()}],[M,{setModalProps:d,closeModal:P}]=R(o=>F(this,null,function*(){yield u(),d({confirmLoading:!1}),e.value=!!(o!=null&&o.isUpdate);let p=o.record;i({field:"value",label:a[p.type]}),yield i([{field:"type",componentProps:{options:m,onChange:c=>{i({field:"value",label:a[c.target.value]})}}},{field:"name",dynamicRules:()=>[{required:!0,whitespace:!0,message:"\u6807\u8BC6\u4E0D\u80FD\u4E3A\u7A7A\uFF01"},{max:80,message:"\u5B57\u7B26\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E80\uFF01"},...y({id:E(e)&&p&&p.id||"",field:"name",fieldValue:"",fieldName:"\u540D\u79F0"})]}]),s(h({},o.record))})),_=O(()=>E(e)?"\u4FEE\u6539":"\u65B0\u589E");function b(){return F(this,null,function*(){try{d({confirmLoading:!0});const o=yield l();yield $(o),P(),t("success")}finally{d({confirmLoading:!1})}})}return{registerModal:M,registerForm:n,getTitle:_,handleSubmit:b}}});function W(r,t,e,m,a,n){const u=v("BasicForm"),i=v("BasicModal");return U(),j(i,G(r.$attrs,{onRegister:r.registerModal,title:r.getTitle,onOk:r.handleSubmit}),{default:q(()=>[z(u,{onRegister:r.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var Le=S(I,[["render",W]]);export{Le as default};
